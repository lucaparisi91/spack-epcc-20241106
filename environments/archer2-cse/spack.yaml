# This is a Spack Environment file.
#
# It describes a set of packages to be installed, along with
# configuration settings.

spack:
  definitions:
  - cse_specs:
    - gromacs%gcc@11.2.0
    - gromacs%cce
    - lammps%gcc@11.2.0
    - python
    - openfoam%gcc
    - petsc %gcc@11.2.0
    - petsc %cce@15.0.0
    - petsc %aocc fortran=false

  modules:
    default:
      'enable:':
      - lmod

      use_view: false
      roots:
        lmod: $spack/../archer2-cse/modules
      lmod:
        projections:
          all: '{name}/{version}'
          gcc: spackEnv-gnu/{version}
          aocc: spackEnv-aocc/{version}
          cce: spackEnv-cray/{version}
        gcc:
          template: compiler-template.lua
        cce:
          template: compiler-template.lua
        aocc:
          template: compiler-template.lua

        exclude:
        - cray-mpich
        - cray-libsci
        - libfabric
        - fftw
        - hdf5
        - cray-fftw

        hash_length: 0
        core_compilers: [gcc@7.5.0]
        include:
        - gcc
        - cce
        - aocc
        hide_implicits: true
        all:
          autoload: direct
        core_specs: [python, gcc, cce, aocc]
        hierarchy: []
      arch_folder: false
    prefix_inspections:
      ./lib:
      - LD_LIBRARY_PATH
      ./lib64:
      - LD_LIBRARY_PATH


  specs:
  - gcc@11.2.0
  - cce@15.0.0
  - $cse_specs

  - petsc%cce
  - aocc
  concretizer:
    unify: false
  config:
    install_tree:
      root: $spack/../archer2-cse/opt
    template_dirs:
    - $spack/../archer2-cse/templates

  view: false
